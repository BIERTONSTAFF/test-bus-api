## Структура БД
### Таблица: `route_stops`
| Поле        | Тип данных       | Описание                                  |
|-------------|------------------|-------------------------------------------|
| `id`        | `int4`           | Идентификатор записи в таблице            |
| `route_id`  | `int4`           | Идентификатор маршрута (внешний ключ)     |
| `stop_id`   | `int4`           | Идентификатор остановки (внешний ключ)    |
| `position`  | `int4`           | Позиция остановки в маршруте              |
| `direction` | `smallint`       | Направление маршрута (по умолчанию 0)     |
| `arrival`   | `time`           | Время прибытия на остановку               |

#### Внешние ключи:
- `route_id` ссылается на `id` таблицы `routes`.
- `stop_id` ссылается на `id` таблицы `stops`.

### Таблица: `routes`
| Поле           | Тип данных       | Описание                                         |
|----------------|------------------|--------------------------------------------------|
| `id`           | `int4`           | Идентификатор маршрута                           |
| `begin_stop_id`| `int4`           | Идентификатор начальной остановки (внешний ключ) |
| `end_stop_id`  | `int4`           | Идентификатор конечной остановки (внешний ключ)  |
| `name`         | `varchar(255)`   | Название маршрута                                |

#### Внешние ключи:
- `begin_stop_id` ссылается на `id` таблицы `stops`.
- `end_stop_id` ссылается на `id` таблицы `stops`.

### Таблица: `stops`
| Поле        | Тип данных       | Описание                           |
|-------------|------------------|------------------------------------|
| `id`        | `int4`           | Идентификатор остановки            |
| `name`      | `varchar(255)`   | Название остановки                 |

## Прямое отправление
GET http://localhost:8000/api/find-bus?from=1&to=2
```json
{
    "from": "ул. Пушкина",
    "to": "ул. Ленина",
    "buses": [
        {
            "route": "Автобус №21 в сторону ост. Попова",
            "next_arrivals": [
                "20:05"
            ]
        },
        {
            "route": "Автобус №11 в сторону ул. Ленина",
            "next_arrivals": [
                "20:00"
            ]
        }
    ]
}
```

## Обратное отправление
GET http://localhost:8000/api/find-bus?from=3&to=1
```json
{
    "from": "ост. Попова",
    "to": "ул. Пушкина",
    "buses": [
        {
            "route": "Автобус №21 в сторону ул. Пушкина",
            "next_arrivals": [
                "20:45"
            ]
        }
    ]
}
```

# Обновление остановок маршрута
PUT http://localhost:8000/api/routes
```json
{
    "route_id": 3,
    "stops": [
        {
            "id": 4,
            "minutesFromStart": 0
        },
        {
            "id": 5,
            "minutesFromStart": 15
        },
        {
            "id": 6,
            "minutesFromStart": 30
        }
    ],
    "startArrival": "20:05:00",
    "direction": 0
}
```
Response:
```json
{
    "message": "Маршрут обновлен"
}
```
# Docker

Cборка:
`$ docker compose up --build -d`

Образ на [DockerHub](https://hub.docker.com/r/biertonstaff/test-bus-api)
